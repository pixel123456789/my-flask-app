<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Admin Messages</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <header>
        <nav>
            <div class="logo">LK</div>
            <div id="dateTime" class="nav-date-time"></div>
            <button id="hamburger-menu" class="hamburger-menu">&#9776;</button>
            <ul id="desktop-menu" class="menu">
                <li><a href="{{ url_for('home') }}">Home</a></li>
                {% if current_user.is_authenticated %}
                    <li><a href="{{ url_for('dashboard') }}">Dashboard</a></li>
                    <li><a href="{{ url_for('home') }}#contact">Contact</a></li>
                    <li><a href="{{ url_for('logout') }}">Logout</a></li>
                {% else %}
                    <li><a href="{{ url_for('home') }}#contact">Contact</a></li>
                    <li><a href="{{ url_for('register') }}">Register</a></li>
                    <li><a href="{{ url_for('login') }}">Login</a></li>
                {% endif %}
            </ul>
            <div id="mobile-menu" class="mobile-menu">
                <button id="close-btn" class="close-btn">&times;</button>
                <ul class="menu">
                    <li><a href="{{ url_for('home') }}">Home</a></li>
                    <br>
                    {% if current_user.is_authenticated %}
                        <li><a href="{{ url_for('dashboard') }}">Dashboard</a></li>
                        <br>
                        <li><a href="{{ url_for('home') }}#contact">Contact</a></li>
                        <br>
                        <li><a href="{{ url_for('logout') }}">Logout</a></li>
                        <br>
                    {% else %}
                        <li><a href="{{ url_for('home') }}#contact">Contact</a></li>
                        <br>
                        <li><a href="{{ url_for('register') }}">Register</a></li>
                        <br>
                        <li><a href="{{ url_for('login') }}">Login</a></li>
                    {% endif %}
                </ul>
            </div>
        </nav>
    </header>
    <div class="dashboard-container">
        <h2>Contact Messages</h2>
        <table class="quote-table">
            <thead>
                <tr>
                    <th>Username</th>
                    <th>Name</th>
                    <th>Email</th>
                    <th>Message</th>
                    <th>Timestamp</th>
                </tr>
            </thead>
            <tbody>
                {% if messages %}
                    {% for message in messages %}
                    <tr>
                        <td>{{ message.username }}</td>
                        <td>{{ message.name }}</td>
                        <td>{{ message.email }}</td>
                        <td>{{ message.message }}</td>
                        <td>{{ message.timestamp }}</td>
                    </tr>
                    {% endfor %}
                {% else %}
                    <tr>
                        <td colspan="5">No messages found</td>
                    </tr>
                {% endif %}
            </tbody>
        </table>
    
        <h2>Reviews</h2>
        <table class="quote-table">
            <thead>
                <tr>
                    <th>Username</th>
                    <th>Review Text</th>
                    <th>Rating</th>
                    <th>Timestamp</th>
                    <th>Status</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% if reviews %}
                    {% for review in reviews %}
                    <tr>
                        <td>{{ review.username }}</td>
                        <td>{{ review.review_text }}</td>
                        <td>{{ review.rating }}</td>
                        <td>{{ review.timestamp }}</td>
                        <td>{{ review.status }}</td>
                        <td>
                            <form method="post" action="{{ url_for('update_review_status') }}" style="display:inline;">
                                <input type="hidden" name="review_id" value="{{ review.id }}">
                                <button type="submit" name="action" value="accept" class="btn">Accept</button>
                                <button type="submit" name="action" value="deny" class="btn">Deny</button>
                            </form>
                        </td>
                    </tr>
                    {% endfor %}
                {% else %}
                    <tr>
                        <td colspan="6">No reviews found</td>
                    </tr>
                {% endif %}
            </tbody>            
        </table>
    </div>
    
    <footer>
        <p>&copy; 2024 Liam Kinnaird. All rights reserved.</p>
    </footer>
    <script>// Function to update date and time
        function updateDateTime() {
            const now = new Date();
            const dateTimeString = now.toLocaleString('en-US', {
                dateStyle: 'medium',
                timeStyle: 'medium',
                hour12: true
            });
            document.getElementById('dateTime').innerText = dateTimeString;
        }

        document.getElementById('hamburger-menu').addEventListener('click', function() {
            document.getElementById('mobile-menu').classList.toggle('active');
        });

        document.getElementById('close-btn').addEventListener('click', function() {
            document.getElementById('mobile-menu').classList.remove('active');
        });
        
        // Update the date and time every second
        setInterval(updateDateTime, 1000);
        // Initial call to display the date and time immediately
        updateDateTime();</script>
</body>
</html>
